<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Order Management System - API Testing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background-color: #f5f5f5;
        }

        h1 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }

        .endpoint {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-left: 4px solid #4CAF50;
        }

        .method {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }

        .method.get { background: #4CAF50; }
        .method.post { background: #2196F3; }
        .method.put { background: #FF9800; }
        .method.delete { background: #F44336; }

        input, textarea, button {
            margin: 5px 0;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        textarea {
            width: 100%;
            height: 120px;
            font-family: monospace;
        }

        button {
            background: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            padding: 10px 20px;
            font-weight: bold;
        }

        button:hover {
            background: #45a049;
        }

        .result {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .success { color: #4CAF50; }
        .error { color: #F44336; }

        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            margin-left: 10px;
        }

        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
<h1>üì¶ Order Management System - API Testing</h1>

<div class="endpoint">
    <h3><span class="method get">GET</span> /orders - Get All Orders</h3>
    <p>Retrieve all orders from the system.</p>
    <button onclick="getAllOrders()">Test GET /orders</button>
</div>

<div class="endpoint">
    <h3><span class="method get">GET</span> /orders/{id} - Get Order by ID</h3>
    <p>Retrieve a specific order by its ID.</p>
    <input id="orderId" placeholder="Enter Order ID (e.g., 1)" type="text">
    <button onclick="getOrderById()">Test GET /orders/{id}</button>
</div>

<div class="endpoint">
    <h3><span class="method post">POST</span> /orders - Create New Order</h3>
    <p>Create a new order with products.</p>
    <textarea id="orderData">
{
  "products": [
    {
      "id": 1,
      "name": "Laptop",
      "cost": 1500.0
    },
    {
      "id": 2,
      "name": "Wireless Mouse",
      "cost": 35.5
    }
  ]
}</textarea>
    <button onclick="createOrder()">Test POST /orders</button>
</div>

<div class="endpoint">
    <h3><span class="method put">PUT</span> /orders/{id} - Update Order</h3>
    <p>Update an existing order.</p>
    <input id="updateOrderId" placeholder="Order ID to update" type="text">
    <textarea id="updateOrderData">
{
  "products": [
    {
      "id": 3,
      "name": "Tablet",
      "cost": 450.0
    }
  ]
}</textarea>
    <button onclick="updateOrder()">Test PUT /orders/{id}</button>
</div>

<div class="endpoint">
    <h3><span class="method delete">DELETE</span> /orders/{id} - Delete Order</h3>
    <p>Delete an order by ID.</p>
    <input id="deleteOrderId" placeholder="Order ID to delete" type="text">
    <button onclick="deleteOrder()">Test DELETE /orders/{id}</button>
</div>

<div id="resultContainer" style="display: none;">
    <h2> API Response</h2>
    <div class="result" id="result"></div>
</div>

<script>

    const BASE_URL = 'http://localhost:8080/order-management/orders';


    function showResult(title, data, statusCode, isError = false) {
        const resultContainer = document.getElementById('resultContainer');
        const resultDiv = document.getElementById('result');

        resultContainer.style.display = 'block';

        let resultHTML = `<div class="${isError ? 'error' : 'success'}">
            <h3>${title} <span class="status ${isError ? 'error' : 'success'}">${statusCode}</span></h3>`;

        if (typeof data === 'string') {
            resultHTML += `<pre>${data}</pre>`;
        } else if (data === null || data === undefined) {
            resultHTML += `<pre>No response body</pre>`;
        } else {
            resultHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        }

        resultHTML += `</div>`;
        resultDiv.innerHTML = resultHTML;


        resultContainer.scrollIntoView({ behavior: 'smooth' });
    }


    function handleError(error, operation) {
        console.error(`${operation} error:`, error);
        showResult(`‚ùå ${operation} Failed`, error.message || 'Unknown error', 'ERROR', true);
    }


    async function getAllOrders() {
        try {
            const response = await fetch(BASE_URL);
            const data = await response.json();
            showResult('‚úÖ GET All Orders Successful', data, response.status);
        } catch (error) {
            handleError(error, 'GET All Orders');
        }
    }

    async function getOrderById() {
        const orderId = document.getElementById('orderId').value.trim();

        if (!orderId) {
            alert('Please enter an Order ID');
            return;
        }

        try {
            const response = await fetch(`${BASE_URL}/${orderId}`);

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`HTTP ${response.status}: ${errorText}`);
            }

            const data = await response.json();
            showResult(`‚úÖ GET Order ${orderId} Successful`, data, response.status);
        } catch (error) {
            handleError(error, `GET Order ${orderId}`);
        }
    }

    async function createOrder() {
        const orderData = document.getElementById('orderData').value;

        try {
            const response = await fetch(BASE_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: orderData
            });

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`HTTP ${response.status}: ${errorText}`);
            }

            const data = await response.json();
            showResult('‚úÖ POST Create Order Successful', data, response.status);
        } catch (error) {
            handleError(error, 'POST Create Order');
        }
    }


    async function updateOrder() {
        const orderId = document.getElementById('updateOrderId').value.trim();
        const orderData = document.getElementById('updateOrderData').value;

        if (!orderId) {
            alert('Please enter an Order ID to update');
            return;
        }

        try {
            const response = await fetch(`${BASE_URL}/${orderId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: orderData
            });

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`HTTP ${response.status}: ${errorText}`);
            }

            const data = await response.json();
            showResult(`‚úÖ PUT Update Order ${orderId} Successful`, data, response.status);
        } catch (error) {
            handleError(error, `PUT Update Order ${orderId}`);
        }
    }


    async function deleteOrder() {
        const orderId = document.getElementById('deleteOrderId').value.trim();

        if (!orderId) {
            alert('Please enter an Order ID to delete');
            return;
        }

        try {
            const response = await fetch(`${BASE_URL}/${orderId}`, {
                method: 'DELETE'
            });

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`HTTP ${response.status}: ${errorText}`);
            }

            if (response.status === 204) {
                showResult(`‚úÖ DELETE Order ${orderId} Successful`,
                          'Order deleted successfully (204 No Content)',
                          response.status);
            } else {
                const data = await response.json();
                showResult(`‚úÖ DELETE Order ${orderId} Successful`, data, response.status);
            }
        } catch (error) {
            handleError(error, `DELETE Order ${orderId}`);
        }
    }


    window.testAll = async function() {
        console.log('Starting comprehensive API test...');

         1. –°—Ç–≤–æ—Ä—é—î–º–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
        await createOrder();
        await new Promise(resolve => setTimeout(resolve, 500));

         2. –û—Ç—Ä–∏–º—É—î–º–æ –≤—Å—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
        await getAllOrders();
        await new Promise(resolve => setTimeout(resolve, 500));

         3. –û–Ω–æ–≤–ª—é—î–º–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ ID = 1)
        await updateOrder();
        await new Promise(resolve => setTimeout(resolve, 500));

         4. –û—Ç—Ä–∏–º—É—î–º–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
        await getOrderById();

        alert('Comprehensive test completed! Check results below.');
    };

     –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤—Å—ñ—Ö —Ç–µ—Å—Ç—ñ–≤
    document.body.innerHTML += `
        <div class="endpoint">
            <h3>Comprehensive Test</h3>
            <p>Run all API tests in sequence.</p>
            <button onclick="testAll()" style="background: #9C27B0;">Run All Tests</button>
        </div>
    `;
</script>
</body>
</html>